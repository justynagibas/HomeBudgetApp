{% extends "main_layout.html" %}
{% block content %}
    <div class="container text-center">
        <h1>Transaction tracking</h1>
    </div>

    <div class="row justify-content-between" style="margin-top: 200px">
        <div class="col-lg-4 text-center">
            <div class="vertical-div">
                    <button type="button" class="btn btn-primary" style="scale:3.5" onclick="showModal('income')">Add income</button>
            </div>
        </div>
        <div class="col-lg-4 text-center">
            <div class="vertical-div">
                    <button type="button" class="btn btn-primary" style="scale:3.5" onclick="showModal('outcome')">Add outcome</button>
            </div>
        </div>
    </div>

    <div class="modal" id="popupModal" tabindex="-1" role="dialog" aria-labelledby="popupModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="popupModalLabel">Add outcome</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form action="" method="post" id="dynamicForm">
                        {{ form1.hidden_tag() }}
                        <div class="form-group">
                            <label for="name">Note:</label>
                            <input type="text" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="name">Value:</label>
                            <input type="text" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="name">Date:</label>
                            <input type="date" max='9999-12-31' class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="name">Main category:</label>
                            <select class="form-control" aria-label="Main category" required>
                                <option hidden disabled selected value> Choose main category </option>
                                {% for category in categories1[0] %}
                                    <option value="{{ loop.index0 }}">{{ category }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="form-group" id="subcategoryField">
                            <label for="name">Subcategory:</label>
                            <select class="form-control" aria-label="Subcategory" required>
                                <option hidden disabled selected value> Choose subcategory </option>
                                {% for category in categories1[1] %}
                                    <option value="{{ category.id }}">{{ category.category_name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <button type="submit" class="btn btn-primary">Submit</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
function showModal(formType) {
    var form = document.getElementById('dynamicForm');
    form.setAttribute('action', '/submit?form_type=' + formType);

    var modalTitle = document.getElementById('popupModalLabel');
    if (formType === 'income') {
        modalTitle.innerText = 'Add Income';
        hideSubcategoryField();
    } else {
        modalTitle.innerText = 'Add Outcome';
        showSubcategoryField();
    }

    $('#popupModal').modal('show');
}

    function hideSubcategoryField() {
        var subcategoryField = document.getElementById('subcategoryField');
        subcategoryField.style.display = 'none';
    }

    function showSubcategoryField() {
        var subcategoryField = document.getElementById('subcategoryField');
        subcategoryField.style.display = 'block';
    }
</script>
{% endblock %}
